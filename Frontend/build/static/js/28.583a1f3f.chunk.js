(this.webpackJsonpdemeter=this.webpackJsonpdemeter||[]).push([[28],{126:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var s=a(4),n=a(1),l=a(50),c=a(51),r=a(46),o=a.n(r),i=a(44),d=a.n(i),m=(a(99),a(0));function j(e){var t=e.getLogin,a=e.wideView,r=Object(n.useState)({email:"",confirmEmail:""}),i=Object(s.a)(r,2),j=i[0],b=i[1],h=Object(n.useState)({phoneNumber:"",firstName:"",lastName:""}),u=Object(s.a)(h,2),p=u[0],x=u[1],O=Object(n.useState)({oldPassword:"",newPassword:"",confirmNewPassword:""}),f=Object(s.a)(O,2),N=f[0],g=f[1],w=Object(n.useState)(!1),v=Object(s.a)(w,2),y=v[0],P=v[1],C=Object(n.useState)(!1),S=Object(s.a)(C,2),F=S[0],E=S[1],T=Object(n.useState)(!1),k=Object(s.a)(T,2),z=k[0],I=k[1],D=Object(n.useState)(!1),A=Object(s.a)(D,2),q=A[0],K=A[1],L=Object(n.useState)(!1),B=Object(s.a)(L,2),U=B[0],Y=B[1],J=Object(n.useState)(!1),M=Object(s.a)(J,2),V=M[0],G=M[1],H=Object(n.useState)(!1),Q=Object(s.a)(H,2),R=Q[0],W=Q[1],X=Object(n.useState)("-"),Z=Object(s.a)(X,2),$=Z[0],_=Z[1],ee=Object(n.useState)(!1),te=Object(s.a)(ee,2),ae=te[0],se=te[1],ne=Object(n.useState)("-"),le=Object(s.a)(ne,2),ce=le[0],re=le[1],oe=Object(n.useState)(!1),ie=Object(s.a)(oe,2),de=ie[0],me=ie[1],je=Object(n.useState)("-"),be=Object(s.a)(je,2),he=be[0],ue=be[1];Object(n.useEffect)((function(){document.title="Settings | Demeter - The plant meter";var e=t();if(null!==e){var a=e.token;d.a.get("https://smart-plant.azurewebsites.net/api/User",{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){var t=e.data;b({email:t.email,confirmEmail:""}),x({phoneNumber:t.phoneNumber,firstName:t.firstName,lastName:t.lastName})})).catch((function(e){window.location.pathname="/"}))}else window.location.pathname="/"}),[]);var pe=function(e){var t=e.target,a=o.a.cloneDeep(j);a[t.name]=t.value,b(a)},xe=function(e){var t=e.target,a=o.a.cloneDeep(p);a[t.name]=t.value,x(a)},Oe=function(e){var t=e.target,a=o.a.cloneDeep(N);a[t.name]=t.value,g(a)};return Object(m.jsxs)("section",{children:[Object(m.jsx)("h1",{className:"text-center gold",children:"Settings"}),Object(m.jsxs)("form",{className:a?"w-25 m-auto mt-4":"m-auto mt-4 px-2",onSubmit:function(e){e.preventDefault(),_("Please wait..."),W(!0);var a=t();if(j.email!==j.confirmEmail)_("Emails do not match.");else if(null!==a){var s=a.token;d.a.put("https://smart-plant.azurewebsites.net/api/User/Email",j,{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){window.location.reload()})).catch((function(e){var t=e.response.data.errors,a="Server error. Please try again later.";void 0!==t.Email?a=t.Email[0]:void 0!==t.ConfirmEmail&&(a=t.ConfirmEmail[0]),_(a)}))}else _("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[y?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"email",children:"Email"}),Object(m.jsx)("input",{className:"form-control",name:"email",type:"text",required:!0,value:j.email,onChange:pe}),Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"confirmEmail",children:"Confirm email"}),Object(m.jsx)("input",{className:"form-control",name:"confirmEmail",type:"text",required:!0,value:j.confirmEmail,onChange:pe})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Email"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(l.a,{className:"gold light-gold-hover",tabIndex:"0",icon:c.a,style:{cursor:"pointer"},onClick:function(){P(!0)},onKeyPress:function(){P(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:j.email})})]}),Object(m.jsx)("div",{className:R?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:$})}),Object(m.jsx)("div",{className:y?"text-center mt-3":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:y?"0":"-1",type:"submit",children:"Apply change"})})]}),Object(m.jsxs)("form",{className:a?"w-25 m-auto mt-5":"m-auto mt-5 px-2",onSubmit:function(e){e.preventDefault(),re("Please wait..."),se(!0);var a=t();if(null!==a){var s=a.token;d.a.put("https://smart-plant.azurewebsites.net/api/User",p,{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){window.location.reload()})).catch((function(e){var t=e.response.data.messages,a="Server error. Please try again later.";void 0!==t.Phone?a=t.Phone[0]:void 0!==t.FirstName?a=t.FirstName[0]:void 0!==t.LastName&&(a=t.LastName[0]),re(a)}))}else re("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[z?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"phoneNumber",children:"Phone"}),Object(m.jsx)("input",{className:"form-control",name:"phoneNumber",type:"text",value:p.phoneNumber,onChange:xe})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Phone"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(l.a,{className:"gold light-gold-hover",tabIndex:"0",icon:c.a,style:{cursor:"pointer"},onClick:function(){E(!0),I(!0)},onKeyPress:function(){E(!0),I(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:p.phoneNumber})})]}),q?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"firstName",children:"First name"}),Object(m.jsx)("input",{className:"form-control",name:"firstName",type:"text",value:p.firstName,onChange:xe})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2 p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"First name"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(l.a,{className:"gold light-gold-hover",tabIndex:"0",icon:c.a,style:{cursor:"pointer"},onClick:function(){E(!0),K(!0)},onKeyPress:function(){E(!0),K(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:p.firstName})})]}),U?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"lastName",children:"Last name"}),Object(m.jsx)("input",{className:"form-control",name:"lastName",type:"text",value:p.lastName,onChange:xe})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2 p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Last name"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(l.a,{className:"gold light-gold-hover",tabIndex:"0",icon:c.a,style:{cursor:"pointer"},onClick:function(){E(!0),Y(!0)},onKeyPress:function(){E(!0),Y(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:p.lastName})})]}),Object(m.jsx)("div",{className:ae?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:ce})}),Object(m.jsx)("div",{className:F?"text-center mt-3":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:F?"0":"-1",type:"submit",children:"Apply changes"})})]}),Object(m.jsxs)("form",{className:a?"w-25 m-auto mt-5":"m-auto mt-5 px-2",onSubmit:function(e){e.preventDefault(),ue("Please wait..."),me(!0);var a=t();if(N.newPassword!==N.confirmNewPassword)ue("New passwords do not match.");else if(null!==a){var s=a.token;d.a.put("https://smart-plant.azurewebsites.net/api/User/Password",N,{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){ue("Password updated successfully."),setTimeout((function(){window.location.reload()}),1e3)})).catch((function(e){var t=e.response.data.messages,a="Server error. Please try again later.";void 0!==t.PasswordMismatch&&(a=t.PasswordMismatch[0]),void 0!==t.PasswordTooShort?a=t.PasswordTooShort[0]:void 0!==t.ConfirmNewPassword&&(a=t.ConfirmNewPassword[0]),ue(a)}))}else ue("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[V?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"oldPassword",children:"Old password"}),Object(m.jsx)("input",{className:"form-control",name:"oldPassword",type:"password",required:!0,value:N.oldPassword,onChange:Oe}),Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"newPassword",children:"New password"}),Object(m.jsx)("input",{className:"form-control",name:"newPassword",type:"password",required:!0,value:N.newPassword,onChange:Oe}),Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"confirmNewPassword",children:"Confirm new password"}),Object(m.jsx)("input",{className:"form-control",name:"confirmNewPassword",type:"password",required:!0,value:N.confirmNewPassword,onChange:Oe})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2 p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Password"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(l.a,{className:"gold light-gold-hover",tabIndex:"0",icon:c.a,style:{cursor:"pointer"},onClick:function(){G(!0)},onKeyPress:function(){G(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})})]}),Object(m.jsx)("div",{className:de?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:he})}),Object(m.jsx)("div",{className:V?a?"text-center mt-3":"text-center mt-3 mb-2":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:V?"0":"-1",type:"submit",children:"Change password"})})]})]})}},99:function(e,t,a){}}]);
//# sourceMappingURL=28.583a1f3f.chunk.js.map