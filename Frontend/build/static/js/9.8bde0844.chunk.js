(this.webpackJsonpdemeter=this.webpackJsonpdemeter||[]).push([[9],{102:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return m}));var n=a(4),l=a(1),s=(a(102),a(46)),i=a.n(s),r=a(44),c=a.n(r),o=a(0);function m(e){var t=e.getLogin,a=e.wideView,s=new FileReader;s.onload=function(e){var t=i.a.cloneDeep(h),a=e.target.result,n=a.indexOf(",")+1;a=a.substr(n),t.base64ImgString=a,j(t)};var r=Object(l.useState)([]),m=Object(n.a)(r,2),d=m[0],u=m[1],p=Object(l.useState)({plantName:"",plantType:"",base64ImgString:""}),b=Object(n.a)(p,2),h=b[0],j=b[1],f=Object(l.useState)(!1),g=Object(n.a)(f,2),v=g[0],x=g[1],O=Object(l.useState)("-"),w=Object(n.a)(O,2),N=w[0],y=w[1];Object(l.useEffect)((function(){document.title="Add plant | Demeter - The plant meter";var e=t();if(null!==e){var a=e.token;c.a.get("https://smart-plant.azurewebsites.net/api/Plants/List",{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){u(e.data)})).catch((function(e){window.location.pathname="/"}))}else window.location.pathname="/"}),[]);var S=function(e){var t=e.target;if("base64ImgString"===t.name)s.readAsDataURL(t.files[0]);else{var a=i.a.cloneDeep(h);a[t.name]=t.value,j(a)}};return Object(o.jsxs)("section",{children:[Object(o.jsx)("h1",{className:"gold text-center",children:"Add plant"}),Object(o.jsxs)("form",{className:a?"w-25 m-auto mt-4":"m-auto mt-4 px-2",onSubmit:function(e){e.preventDefault(),y("Please wait..."),x(!0);var a=t();if(null!==a){var n=a.token;c.a.post("https://smart-plant.azurewebsites.net/api/Plants",h,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){var t=encodeURIComponent(e.data.messages.Token[0]);window.location.assign("https://www.demeter.onl/plant-added?token=".concat(t))})).catch((function(e){var t=e.response.data.messages,a="Server error. Please try again later.";void 0!==t.PlantName?a=t.PlantName[0]:void 0!==t["Name Taken"]?a=t["Name Taken"][0]:void 0!==t["Plant Type"]?a=t["Plant Type"][0]:void 0!==t.Limit&&(a=t.Limit[0]),y(a)}))}else y("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[Object(o.jsx)("label",{className:"form-label gold",htmlFor:"plantName",children:"Name"}),Object(o.jsx)("input",{type:"text",className:"form-control",name:"plantName",value:h.plantName,onChange:S,required:!0}),Object(o.jsx)("label",{className:"form-label gold mt-3",htmlFor:"plantType",children:"Variety"}),Object(o.jsx)("select",{className:"form-control",name:"plantType",onChange:S,required:!0,children:0===d.length?Object(o.jsx)("option",{value:"",children:"Loading plant varieties..."},"default"):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("option",{value:"",children:"Please select a plant"},"default"),d.sort().map((function(e){return Object(o.jsx)("option",{value:e,children:e},e)}))]})}),Object(o.jsxs)("div",{className:"form-text mt-2",style:{color:"white"},children:["Plant varieties courtesy of\xa0",Object(o.jsx)("a",{className:"gold light-gold-hover",href:"https://extension.uga.edu/publications/detail.html?number=B1318&title=Growing%20Indoor%20Plants%20with%20Success",style:{textDecoration:"none"},children:"University of Georgia"}),"."]}),Object(o.jsx)("label",{className:"form-label gold mt-3",htmlFor:"base64ImgString",children:"Image"}),Object(o.jsx)("input",{className:"form-control",name:"base64ImgString",onChange:S,type:"file"}),v?Object(o.jsx)("div",{className:"text-center mt-3",children:Object(o.jsx)("span",{children:N})}):Object(o.jsx)("div",{className:"hidden-field mt-3",children:Object(o.jsx)("span",{children:N})}),Object(o.jsx)("div",{className:a?"text-center mt-3":"text-center mt-3 mb-2",children:Object(o.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Add plant"})})]})]})}}}]);
//# sourceMappingURL=9.8bde0844.chunk.js.map