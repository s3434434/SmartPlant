(this.webpackJsonpdemeter=this.webpackJsonpdemeter||[]).push([[23],{104:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var n=a(4),c=a(1),s=a(50),i=a(51),l=a(46),r=a.n(l),o=a(44),d=a.n(o),m=(a(104),a(0));function j(e){var t=e.getLogin,l=e.wideView,o=Object(c.lazy)((function(){return a.e(4).then(a.bind(null,63))})),j=window.location.pathname.lastIndexOf("/")+1,b=window.location.pathname.substr(j),h=new FileReader;h.onload=function(e){var t=r.a.cloneDeep(x),a=e.target.result,n=a.indexOf(",")+1;a=a.substr(n),t.base64ImgString=a,p(t)};var u=Object(c.useState)({name:"",base64ImgString:""}),O=Object(n.a)(u,2),x=O[0],p=O[1],f=Object(c.useState)(!1),g=Object(n.a)(f,2),v=g[0],w=g[1],N=Object(c.useState)(!1),S=Object(n.a)(N,2),y=S[0],k=S[1],D=Object(c.useState)(!1),P=Object(n.a)(D,2),I=P[0],T=P[1],z=Object(c.useState)("-"),A=Object(n.a)(z,2),C=A[0],F=A[1],B=Object(c.useState)(!1),L=Object(n.a)(B,2),R=L[0],U=L[1],q=Object(c.useState)("-"),Y=Object(n.a)(q,2),E=Y[0],J=Y[1],K=Object(c.useState)(""),V=Object(n.a)(K,2),_=V[0],G=V[1],H=Object(c.useState)(null),M=Object(n.a)(H,2),Q=M[0],W=M[1],X=Object(c.useState)(""),Z=Object(n.a)(X,2),$=Z[0],ee=Z[1],te=Object(c.useState)(!1),ae=Object(n.a)(te,2),ne=ae[0],ce=ae[1],se=Object(c.useState)(!1),ie=Object(n.a)(se,2),le=ie[0],re=ie[1],oe=Object(c.useState)("-"),de=Object(n.a)(oe,2),me=de[0],je=de[1],be=Object(c.useState)(null),he=Object(n.a)(be,2),ue=he[0],Oe=he[1],xe=Object(c.useState)(!1),pe=Object(n.a)(xe,2),fe=pe[0],ge=pe[1],ve=Object(c.useState)("-"),we=Object(n.a)(ve,2),Ne=we[0],Se=we[1];Object(c.useEffect)((function(){document.title="Demeter - The plant meter";var e=t();if(null!==e){var a=e.token;d.a.get("https://smart-plant.azurewebsites.net/api/Plants",{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){var t=!1;e.data.forEach((function(e){if(e.plantID===b){document.title="".concat(e.name," | Demeter - The plant meter");var a=r.a.cloneDeep(x);a.name=e.name,p(a);var n="https://d3utxwpu6rqzip.cloudfront.net/container_no_image.png";null!==e.imgurURL&&(n=e.imgurURL),W(n),G(e.plantType),t=!0}})),t||(window.location.pathname="/")})).catch((function(e){window.location.pathname="/"})),d.a.get("https://smart-plant.azurewebsites.net/api/SensorData/".concat(b),{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){var t=e.data.sort((function(e,t){var a=new Date(e.timeStampUTC).getTime(),n=new Date(t.timeStampUTC).getTime();return a>n?-1:a<n?1:0}));Oe(t)})).catch((function(e){Oe("There was an error retrieving your sensor data. Please try again later.")}))}else window.location.pathname="/"}),[]);var ye=function(e){var t=e.target;if("base64ImgString"===t.name)h.readAsDataURL(t.files[0]);else{var a=r.a.cloneDeep(x);a[t.name]=t.value,p(a)}},ke=function(e,a,n){e.preventDefault(),a("Please wait..."),n(!0);var c=t();if(null!==c){var s=c.token,i=r.a.cloneDeep(x);i.plantID=b,d.a.put("https://smart-plant.azurewebsites.net/api/Plants",i,{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){window.location.reload()})).catch((function(e){var t=e.response.data.messages,n="Server error. Please try again later.";void 0!==t.PlantName?n=t.PlantName[0]:void 0!==t["Name Taken"]&&(n=t["Name Taken"][0]),a(n)}))}else a("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},De=function(){Se("Please wait..."),ge(!0);var e=t();if(null!==e){var a=e.token;d.a.delete("https://smart-plant.azurewebsites.net/api/Plants?plantID=".concat(b),{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){window.location.pathname="/"})).catch((function(e){Se("Server error. Please try again later.")}))}else Se("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)};return Object(m.jsx)("section",{children:null!==Q?Object(m.jsxs)(m.Fragment,{children:[l?Object(m.jsx)("div",{className:"container m-0 p-0",children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-xl-2 text-center",children:[Object(m.jsx)("div",{className:fe?"":"hidden-field",children:Object(m.jsx)("span",{style:{color:"white"},children:Ne})}),Object(m.jsx)("button",{className:"btn btn-primary mt-2",onClick:De,children:"Delete plant"})]}),Object(m.jsx)("div",{className:"col-xl-10"})]})}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:fe?"text-center":"hidden-field",children:Object(m.jsx)("span",{style:{color:"white"},children:Ne})}),Object(m.jsx)("div",{className:"text-center",children:Object(m.jsx)("button",{className:"btn btn-primary mt-2",onClick:De,children:"Delete plant"})})]}),Object(m.jsxs)("form",{className:l?"m-auto":"m-auto px-2",onSubmit:function(e){ke(e,F,T)},children:[v?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:l?"w-25 m-auto":"",children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"name",children:"Name"}),Object(m.jsx)("input",{className:"form-control mb-3",name:"name",type:"text",value:x.name,onChange:ye,required:!0})]}),Object(m.jsx)("h4",{className:"text-center m-0 p-0",style:{color:"white"},children:_})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:l?"w-25 m-auto":"",children:Object(m.jsx)("div",{className:"text-end m-0 p-0",children:Object(m.jsx)(s.a,{className:"gold light-gold-hover",tabIndex:"0",icon:i.a,style:{cursor:"pointer"},onClick:function(){w(!0)},onKeyPress:function(){w(!0)}})})}),Object(m.jsx)("h1",{className:"text-center gold m-0 mb-2 p-0",children:x.name}),Object(m.jsx)("h4",{className:"text-center m-0 p-0",style:{color:"white"},children:_})]}),Object(m.jsx)("div",{className:I?"text-center mt-3":l?"hidden-field m-0":"hidden-field",children:Object(m.jsx)("span",{children:C})}),Object(m.jsx)("div",{className:v?"text-center my-3":l?"hidden-field m-0":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:v?"0":"-1",type:"submit",children:"Apply change"})})]}),Object(m.jsxs)("form",{className:l?"w-25 m-auto":"m-auto mt-5 px-2",onSubmit:function(e){ke(e,J,U)},children:[y?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"base64ImgString",children:"Image"}),Object(m.jsx)("input",{className:"form-control",name:"base64ImgString",type:"file",required:!0,onChange:ye})]}):Object(m.jsxs)("div",{className:"text-center",children:[Object(m.jsx)("div",{className:"container p-0",children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsx)("div",{className:"col-sm-10"}),Object(m.jsx)("div",{className:"col-sm-2 text-end",children:Object(m.jsx)(s.a,{className:"gold light-gold-hover",tabIndex:"0",icon:i.a,style:{cursor:"pointer"},onClick:function(){k(!0)},onKeyPress:function(){k(!0)}})})]})}),Object(m.jsx)("img",{className:"plant-image gold-border m-auto mt-1",src:Q,alt:"Plant"})]}),Object(m.jsx)("div",{className:R?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:E})}),Object(m.jsx)("div",{className:y?"text-center mt-3 mb-1":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:y?"0":"-1",type:"submit",children:"Apply change"})})]}),ne?Object(m.jsxs)("div",{className:l?"w-25 m-auto":"m-auto px-2",children:[Object(m.jsx)("h3",{className:"gold text-center mt-1",children:"Arduino token"}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:$})})]}):Object(m.jsxs)("div",{className:l?"w-25 m-auto":"m-auto px-2",children:[Object(m.jsx)("div",{className:le?"text-center mt-1":"hidden-field",children:Object(m.jsx)("span",{style:{color:"white"},children:me})}),Object(m.jsx)("div",{className:"text-center mt-2",children:Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){je("Please wait..."),re(!0);var e=t();if(null!==e){var a=e.token;d.a.get("https://smart-plant.azurewebsites.net/api/Plants/Token/".concat(b),{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){ee(e.data),ce(!0)})).catch((function(e){je("Server error. Please try again later.")}))}else je("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:"Show Arduino token"})})]}),Object(m.jsx)("h3",{className:"gold text-center mt-5",children:"Sensor data"}),Object(m.jsx)(c.Suspense,{fallback:Object(m.jsx)("div",{}),children:Object(m.jsx)(o,{sensorReadings:ue,admin:!1,wideView:l})})]}):Object(m.jsx)("div",{className:l?"text-center mt-3":"text-center mt-3 mb-2",style:{color:"white"},children:"Loading plant..."})})}}}]);
//# sourceMappingURL=23.089969ae.chunk.js.map