(this.webpackJsonpdemeter=this.webpackJsonpdemeter||[]).push([[32],{110:function(e,t,a){},137:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var n=a(4),s=a(1),c=a(50),l=a(51),i=a(46),r=a.n(i),o=a(44),d=a.n(o),m=(a(110),a(0));function j(e){var t=Object(s.lazy)((function(){return a.e(3).then(a.bind(null,52))})),i=e.getLogin,o=e.logOut,j=e.wideView,b=window.location.pathname.lastIndexOf("/")+1,h=window.location.pathname.substr(b),u=Object(s.useState)("Loading..."),p=Object(n.a)(u,2),x=p[0],O=p[1],f=Object(s.useState)({email:"",phoneNumber:"",firstName:"",lastName:""}),N=Object(n.a)(f,2),g=N[0],w=N[1],v=Object(s.useState)({newPassword:"",confirmNewPassword:""}),y=Object(n.a)(v,2),P=y[0],S=y[1],C=Object(s.useState)(!1),F=Object(n.a)(C,2),A=F[0],z=F[1],D=Object(s.useState)(!1),k=Object(n.a)(D,2),I=k[0],T=k[1],U=Object(s.useState)(!1),B=Object(n.a)(U,2),E=B[0],L=B[1],K=Object(s.useState)(!1),R=Object(n.a)(K,2),Y=R[0],q=R[1],V=Object(s.useState)(!1),J=Object(n.a)(V,2),G=J[0],H=J[1],M=Object(s.useState)(!1),Q=Object(n.a)(M,2),W=Q[0],X=Q[1],Z=Object(s.useState)(!1),$=Object(n.a)(Z,2),_=$[0],ee=$[1],te=Object(s.useState)(!1),ae=Object(n.a)(te,2),ne=ae[0],se=ae[1],ce=Object(s.useState)("-"),le=Object(n.a)(ce,2),ie=le[0],re=le[1],oe=Object(s.useState)(!1),de=Object(n.a)(oe,2),me=de[0],je=de[1],be=Object(s.useState)("-"),he=Object(n.a)(be,2),ue=he[0],pe=he[1],xe=Object(s.useState)(!1),Oe=Object(n.a)(xe,2),fe=Oe[0],Ne=Oe[1],ge=Object(s.useState)("-"),we=Object(n.a)(ge,2),ve=we[0],ye=we[1],Pe=Object(s.useState)(!1),Se=Object(n.a)(Pe,2),Ce=Se[0],Fe=Se[1],Ae=Object(s.useState)("-"),ze=Object(n.a)(Ae,2),De=ze[0],ke=ze[1],Ie=Object(s.useState)(!1),Te=Object(n.a)(Ie,2),Ue=Te[0],Be=Te[1],Ee=Object(s.useState)("-"),Le=Object(n.a)(Ee,2),Ke=Le[0],Re=Le[1],Ye=Object(s.useState)("Loading plants..."),qe=Object(n.a)(Ye,2),Ve=qe[0],Je=qe[1];Object(s.useEffect)((function(){document.title="Demeter - The plant meter";var e=i();if(null!==e){var t=e.token;e.admin?(d.a.get("https://smart-plant.azurewebsites.net/api/Admin/User?userID=".concat(h),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var a=e.data;document.title="".concat(a.email," | Demeter - The plant meter");var n=r.a.cloneDeep(g);n.email=a.email,n.phoneNumber=a.phoneNumber,n.firstName=a.firstName,n.lastName=a.lastName,w(n),d.a.get("https://smart-plant.azurewebsites.net/api/Admin/User/Role",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var t=!1;e.data.forEach((function(e){e.id===h&&(O(e.role),t=!0)})),t||(window.location.pathname="/")})).catch((function(e){window.location.pathname="/"}))})).catch((function(e){window.location.pathname="/"})),d.a.get("https://smart-plant.azurewebsites.net/api/Admin/Plants",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var t=[];e.data.forEach((function(e){e.userID===h&&t.push(e)})),(t=t.sort((function(e,t){var a=e.name,n=t.name;return a<n?-1:a>n?1:0}))).length>0?Je(t):Je("No current plants.")})).catch((function(e){window.location.pathname="/"}))):window.location.pathname="/"}else window.location.pathname="/"}),[]);var Ge=function(e){var t=e.target,a=r.a.cloneDeep(g);a[t.name]=t.value,w(a)},He=function(e,t,a){e.preventDefault(),t("Please wait..."),a(!0);var n=i();if(null!==n){var s=n.token,c=r.a.cloneDeep(g);c.id=h,d.a.put("https://smart-plant.azurewebsites.net/api/Admin/User",c,{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){window.location.reload()})).catch((function(e){var a=e.response.data.errors,n="Server error. Please try again later.";void 0!==a.Email?n=a.Email[0]:void 0!==a.ConfirmEmail?n=a.ConfirmEmail[0]:void 0!==a.Phone?n=a.Phone[0]:void 0!==a.FirstName?n=a.FirstName[0]:void 0!==a.LastName&&(n=a.LastName[0]),t(n)}))}else t("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},Me=function(e){var t=e.target,a=r.a.cloneDeep(P);a[t.name]=t.value,S(a)},Qe=function(){Re("Please wait..."),Be(!0);var e=i();if(null!==e){var t=e.token;d.a.get("https://smart-plant.azurewebsites.net/api/User",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var a=e.data.email;d.a.delete("https://smart-plant.azurewebsites.net/api/Admin/User?userID=".concat(h),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){a===g.email?(o(),window.location.pathname="/"):window.location.reload()})).catch((function(e){Re("Server error. Please try again later.")}))})).catch((function(e){Re("Server error. Please try again later.")}))}else Re("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)};return Object(m.jsx)("section",{children:""!==g.email?Object(m.jsxs)(m.Fragment,{children:[j?Object(m.jsx)("div",{className:"container m-0 p-0",children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-xl-2 text-center",children:[Object(m.jsx)("div",{className:Ue?"":"hidden-field",children:Object(m.jsx)("span",{style:{color:"white"},children:Ke})}),Object(m.jsx)("button",{className:"btn btn-primary mt-2",onClick:Qe,children:"Delete user"})]}),Object(m.jsx)("div",{className:"col-xl-10"})]})}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:Ue?"text-center":"hidden-field",children:Object(m.jsx)("span",{style:{color:"white"},children:Ke})}),Object(m.jsx)("div",{className:"text-center",children:Object(m.jsx)("button",{className:"btn btn-primary mt-2",onClick:Qe,children:"Delete user"})})]}),Object(m.jsxs)("form",{className:j?"m-auto":"m-auto px-2",onSubmit:function(e){He(e,re,se)},children:[A?Object(m.jsxs)("div",{className:j?"w-25 m-auto":"",children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"email",children:"Email"}),Object(m.jsx)("input",{className:"form-control mb-3",name:"email",type:"text",value:g.email,onChange:Ge})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:j?"w-25 m-auto":"",children:Object(m.jsx)("div",{className:"text-end m-0 p-0",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){z(!0)},onKeyPress:function(){z(!0)}})})}),Object(m.jsx)("h1",{className:j?"text-center gold m-0 mb-2 p-0":"text-center gold m-0 mb-2 p-0 overflow-hidden",children:g.email})]}),Object(m.jsx)("div",{className:ne?"text-center mt-3":j?"hidden-field m-0":"hidden-field",children:Object(m.jsx)("span",{children:ie})}),Object(m.jsx)("div",{className:A?"text-center my-3":j?"hidden-field m-0":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:A?"0":"-1",type:"submit",children:"Apply change"})})]}),Object(m.jsxs)("form",{className:j?"w-25 m-auto mt-4":"m-auto mt-4 px-2",onSubmit:function(e){e.preventDefault(),pe("Please wait..."),je(!0);var t=i();if("User"!==x&&"Admin"!==x)pe("An appropriate role must be selected.");else if(null!==t){var a=t.token;d.a.put("https://smart-plant.azurewebsites.net/api/Admin/User/Role",{id:h,role:x},{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){window.location.reload()})).catch((function(e){pe("Server error. Please try again later.")}))}else pe("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[I?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"role",children:"Role"}),Object(m.jsxs)("select",{className:"form-control",name:"role",onChange:function(e){O(e.target.value)},required:!0,children:[Object(m.jsx)("option",{value:"",children:"Please select a role"},"default"),Object(m.jsx)("option",{value:"User",children:"User"},"User"),Object(m.jsx)("option",{value:"Admin",children:"Admin"},"Admin")]})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Role"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){T(!0)},onKeyPress:function(){T(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:x})})]}),Object(m.jsx)("div",{className:me?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:ue})}),Object(m.jsx)("div",{className:I?"text-center mt-3":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:I?"0":"-1",type:"submit",children:"Apply change"})})]}),Object(m.jsxs)("form",{className:j?"w-25 m-auto mt-4":"m-auto mt-4 px-2",onSubmit:function(e){He(e,ye,Ne)},children:[Y?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold",htmlFor:"phoneNumber",children:"Phone"}),Object(m.jsx)("input",{className:"form-control",name:"phoneNumber",type:"text",value:g.phoneNumber,onChange:Ge})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:j?"":"mt-2",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Phone"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){L(!0),q(!0)},onKeyPress:function(){L(!0),q(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:g.phoneNumber})})]}),G?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"firstName",children:"First name"}),Object(m.jsx)("input",{className:"form-control",name:"firstName",type:"text",value:g.firstName,onChange:Ge})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"First name"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){L(!0),H(!0)},onKeyPress:function(){L(!0),H(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:g.firstName})})]}),W?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"lastName",children:"Last name"}),Object(m.jsx)("input",{className:"form-control",name:"lastName",type:"text",value:g.lastName,onChange:Ge})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Last name"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){L(!0),X(!0)},onKeyPress:function(){L(!0),X(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:g.lastName})})]}),Object(m.jsx)("div",{className:fe?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:ve})}),Object(m.jsx)("div",{className:E?"text-center mt-3":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:E?"0":"-1",type:"submit",children:"Apply changes"})})]}),Object(m.jsxs)("form",{className:j?"w-25 m-auto mt-4":"m-auto mt-4 px-2",onSubmit:function(e){e.preventDefault(),ke("Please wait..."),Fe(!0);var t=i();if(P.newPassword!==P.confirmNewPassword)ke("New passwords do not match.");else if(null!==t){var a=t.token,n=r.a.cloneDeep(P);n.id=h,d.a.put("https://smart-plant.azurewebsites.net/api/Admin/User/Password",n,{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){ke("Password updated successfully."),setTimeout((function(){window.location.reload()}),1e3)})).catch((function(e){ke(e.response.data[0].description)}))}else ke("You are not logged in."),setTimeout((function(){window.location.pathname="/"}),500)},children:[_?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"newPassword",children:"New password"}),Object(m.jsx)("input",{className:"form-control",name:"newPassword",type:"password",required:!0,value:P.newPassword,onChange:Me}),Object(m.jsx)("label",{className:"form-label gold mt-2",htmlFor:"confirmNewPassword",children:"Confirm new password"}),Object(m.jsx)("input",{className:"form-control",name:"confirmNewPassword",type:"password",required:!0,value:P.confirmNewPassword,onChange:Me})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"mt-2 p-0",style:{display:"grid",gridTemplateColumns:"50% 50%"},children:[Object(m.jsx)("div",{className:"text-left",children:Object(m.jsx)("span",{className:"gold",children:"Password"})}),Object(m.jsx)("div",{className:"text-end",children:Object(m.jsx)(c.a,{className:"gold light-gold-hover",tabIndex:"0",icon:l.a,style:{cursor:"pointer"},onClick:function(){ee(!0)},onKeyPress:function(){ee(!0)}})})]}),Object(m.jsx)("div",{className:"mt-1 py-1 overflow-hidden gold-border",children:Object(m.jsx)("span",{className:"ms-1",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})})]}),Object(m.jsx)("div",{className:Ce?"text-center mt-3":"hidden-field",children:Object(m.jsx)("span",{children:De})}),Object(m.jsx)("div",{className:_?"text-center mt-3":"hidden-field",children:Object(m.jsx)("button",{className:"btn btn-primary",tabIndex:_?"0":"-1",type:"submit",children:"Change password"})})]}),Object(m.jsx)("h1",{className:"text-center gold mt-4",children:"Plants"}),"string"===typeof Ve?Object(m.jsx)("div",{className:j?"text-center mt-3":"text-center mt-3 mb-2",style:{color:"white"},children:Ve}):Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)("div",{}),children:Object(m.jsx)(t,{items:Ve,itemID:"plantID",heading1:"Name",heading2:"Variety",imageCol:!0,itemTitle1:"name",itemTitle2:"plantType",path:"plant-admin",wideView:j})})]}):Object(m.jsx)("div",{className:j?"text-center mt-3":"text-center mt-3 mb-2",style:{color:"white"},children:"Loading user..."})})}}}]);
//# sourceMappingURL=32.ff2747cd.chunk.js.map